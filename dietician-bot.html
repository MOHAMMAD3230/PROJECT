<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advanced Dietician App with Reset Button</title>
<style>
  html, body {
    margin: 0; padding: 0;
    width: 100%; min-height: 100vh;
    font-family: Arial, sans-serif;
    background-color: #121212;
    color: white;
    overflow: auto;
    position: relative;
  }

  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image:
      radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    pointer-events: none;
    z-index: -1;
  }

  #appPanel {
    position: relative;
    max-width: 850px;
    margin: 40px auto 60px;
    background: rgba(20,20,20,0.95);
    border-radius: 16px;
    box-shadow: 0 0 35px rgba(0,255,255,0.15);
    padding: 30px 40px;
    z-index: 10;
  }

  #appPanel h1 {
    color: #00fff7;
    margin-top: 0;
    text-align: center;
    font-weight: bold;
  }

  label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }

  input, textarea, select, button {
    width: 100%;
    padding: 12px 16px;
    margin-bottom: 18px;
    border-radius: 8px;
    background-color: #222;
    border: 1px solid #444;
    color: white;
    font-size: 1em;
    outline: none;
    transition: border-color 0.3s, box-shadow 0.3s;
  }

  input:focus, textarea:focus, select:focus {
    border-color: #00fff7;
    box-shadow: 0 0 10px #00fff7;
  }

  button {
    cursor: pointer;
    border: none;
    background-color: #00fff7;
    color: #111;
    font-weight: 700;
    transition: background-color 0.3s;
  }

  button:hover {
    background-color: #00ccc7;
  }

  textarea {
    resize: vertical;
    min-height: 160px;
    max-height: 320px;
    overflow-y: auto;
    font-family: monospace;
  }

  .row {
    display: flex;
    gap: 22px;
    flex-wrap: wrap;
  }

  .col {
    flex: 1;
    min-width: 170px;
  }

  #dosWidget {
    max-width: 850px;
    background: rgba(0,40,50,0.9);
    margin: 40px auto;
    padding: 30px 40px;
    border-radius: 16px;
    box-shadow: 0 0 35px rgba(0,255,214,0.55);
    color: #8df9e1;
    font-size: 1.05em;
    line-height: 1.6;
    white-space: pre-wrap;
    min-height: 350px;
    max-height: 520px;
    overflow-y: auto;
    user-select: text;
  }

  #dosWidget h2 {
    color: #00ffd6;
    margin-top: 0;
    margin-bottom: 12px;
    font-weight: 700;
    text-align: center;
  }

  /* Button group styling */
  #buttonsGroup {
    display: flex;
    gap: 15px;
    margin-bottom: 25px;
  }
  #buttonsGroup button {
    flex: 1;
  }
</style>
</head>
<body>

<div id="appPanel">
  <h1>Advanced Dietician App</h1>

  <section>
    <h2>Profile Information</h2>
    <div class="row">
      <div class="col">
        <label for="age">Age (years)</label>
        <input type="number" id="age" placeholder="30" />
      </div>
      <div class="col">
        <label for="weight">Weight (kg)</label>
        <input type="number" id="weight" placeholder="70" />
      </div>
      <div class="col">
        <label for="height">Height (cm)</label>
        <input type="number" id="height" placeholder="175" />
      </div>
      <div class="col" style="flex-grow: 2;">
        <label for="diet">Diet Preference</label>
        <input type="text" id="diet" placeholder="e.g. Vegan, Keto" />
      </div>
    </div>

    <div id="buttonsGroup">
      <button id="calcBtn">Calculate BMI & Advice</button>
      <button id="resetBtn" title="Reset all inputs and outputs">Reset All</button>
    </div>

    <textarea id="bmiAdvice" readonly placeholder="Your detailed health advice will appear here."></textarea>
  </section>

  <section>
    <h2>Nutrition Lookup</h2>
    <input type="text" id="foodQuery" placeholder="Enter food name to search" />
    <div id="buttonsGroup">
      <button id="searchBtn">Search Nutrition</button>
    </div>
    <textarea id="nutritionResult" readonly placeholder="Nutrition data will appear here."></textarea>
  </section>
</div>

<div id="dosWidget" aria-live="polite">
  <h2>Your Personalized Do's & Don'ts & Wellness Tips</h2>
  <select id="goalSelect" aria-label="Select your weight goal">
    <option value="" selected disabled>Choose your weight goal...</option>
    <option value="Lose">Weight Loss</option>
    <option value="Gain">Weight Gain</option>
    <option value="Maintain">Weight Maintenance</option>
  </select>
  <div id="buttonsGroup" style="margin-top:10px;">
    <button id="showDosBtn">Show Recommendations</button>
  </div>
  <pre id="dosOutput"></pre>
</div>

<script>
  // Function to clear all inputs and outputs for fresh interaction
  document.getElementById('resetBtn').addEventListener('click', () => {
    // Clear profile inputs
    document.getElementById('age').value = "";
    document.getElementById('weight').value = "";
    document.getElementById('height').value = "";
    document.getElementById('diet').value = "";

    // Clear weight goal select
    document.getElementById('goalSelect').selectedIndex = 0;

    // Clear nutrition query
    document.getElementById('foodQuery').value = "";

    // Clear all output textareas and pre
    document.getElementById('bmiAdvice').value = "";
    document.getElementById('nutritionResult').value = "";
    document.getElementById('dosOutput').textContent = "";
  });

  function calculateBMI(weight, height) {
    const heightM = height / 100;
    return +(weight / (heightM * heightM)).toFixed(1);
  }

  function getBMICategory(bmi) {
    if (bmi < 16.5) return "Severely Underweight";
    if (bmi < 18.5) return "Underweight";
    if (bmi < 25) return "Normal weight";
    if (bmi < 30) return "Overweight";
    if (bmi < 35) return "Obesity Class I";
    if (bmi < 40) return "Obesity Class II";
    return "Obesity Class III";
  }

  function generateDetailedAdvice(weight, height, bmi, category, age, diet, goal) {
    let advice = `=== BMI Calculation & Health Advice ===\n\n`;
    advice += `Step 1: Convert height from cm to meters:\n  ${height} cm = ${(height / 100).toFixed(2)} m\n\n`;
    advice += `Step 2: Square the height in meters:\n  ${(height / 100).toFixed(2)} × ${(height / 100).toFixed(2)} = ${(height / 100 * height / 100).toFixed(4)} m²\n\n`;
    advice += `Step 3: Calculate BMI by weight divided by squared height:\n  ${weight} ÷ ${(height / 100 * height / 100).toFixed(4)} = ${bmi}\n\n`;

    advice += `BMI Classification: ${category}\n\n`;

    switch (category) {
      case "Severely Underweight":
        advice += "- Severe underweight risks: malnutrition, fractures, immunity issues.\n- Increase calorie and nutrient intake with professional guidance.\n";
        break;
      case "Underweight":
        advice += "- Underweight risks: nutrient deficiencies, fatigue.\n- Eat high-calorie, nutrient-dense foods and frequent meals.\n";
        break;
      case "Normal weight":
        advice += "- Normal weight: maintain healthy lifestyle.\n- Balance diet and physical activity.\n";
        break;
      case "Overweight":
        advice += "- Overweight: risk of diabetes, hypertension.\n- Moderate reduction in calories and more activity recommended.\n";
        break;
      case "Obesity Class I":
      case "Obesity Class II":
      case "Obesity Class III":
        advice += "- Obesity risks: cardiovascular disease, diabetes.\n- Seek health professional support for sustainable management.\n";
        break;
    }

    advice += `\nWeight Goal: ${goal}\n`;
    if (goal === "Lose") {
      advice += "- Maintain moderate calorie deficit.\n- Emphasize vegetables, lean protein, hydration.\n- Include cardio and strength training.\n";
    } else if (goal === "Gain") {
      advice += "- Increase nutrition calories, use healthy fats and proteins.\n- Eat more frequent balanced meals.\n- Avoid empty calories.\n";
    } else if (goal === "Maintain") {
      advice += "- Balance calorie intake and physical activity.\n- Monitor weight consistently.\n";
    }

    advice += `\nAdditional Wellness Recommendations:\n`;
    advice += "- Prioritize sleep (7-9 hours nightly).\n- Manage stress with mindfulness or exercise.\n- Stay socially connected.\n";
    advice += "- Limit processed foods, alcohol, and tobacco.\n";

    if (diet && diet.toLowerCase() !== "none") {
      advice += `\nDiet Preference Advice:\n- Adapt to your ${diet} diet ensuring nutrient adequacy.\n`;
    }

    advice += `\nConsult healthcare professionals for personalized advice.\n`;

    return advice;
  }

  function generateGuide(goal, bmiCat, diet) {
    const dos = [
      "Eat a wide variety of colorful fruits and vegetables.",
      "Choose whole grains over refined grains.",
      "Include lean proteins like beans, fish, poultry, and tofu.",
      "Stay hydrated with plenty of water.",
      "Aim for 7-9 hours quality sleep each night.",
      "Practice mindfulness, meditation, or yoga for stress relief.",
      "Engage in at least 150 minutes of moderate exercise each week.",
      "Maintain social connections to support mental well-being."
    ];

    const donts = [
      "Avoid sugary drinks and processed snacks.",
      "Limit saturated and trans fats.",
      "Don't skip meals.",
      "Limit alcohol and avoid tobacco use.",
      "Avoid excessive screen time and sedentary lifestyle.",
      "Pay attention to your mental health; seek help if needed."
    ];

    if (goal === "Lose") {
      dos.unshift("Create a gradual calorie deficit.");
      dos.unshift("Include cardio and strength training workouts.");
      donts.unshift("Avoid late-night snacking and binge eating.");
    } else if (goal === "Gain") {
      dos.unshift("Increase nutrient-dense calorie intake.");
      dos.unshift("Eat multiple balanced meals and snacks daily.");
      donts.unshift("Avoid empty calories and junk foods.");
    } else if (goal === "Maintain") {
      dos.unshift("Balance calorie intake with physical activity.");
      dos.unshift("Monitor weight regularly.");
      donts.unshift("Avoid overeating and excessive processed foods.");
    }

    if (["Severely Underweight", "Underweight"].includes(bmiCat)) {
      dos.push("Eat calorie-rich foods to gain healthy weight.");
      donts.push("Avoid skipping meals or relying on low-nutrient foods.");
    } else if (["Overweight","Obesity Class I","Obesity Class II","Obesity Class III"].includes(bmiCat)) {
      dos.push("Seek help for sustainable weight loss.");
      dos.push("Make gradual lifestyle changes.");
      donts.push("Avoid fad and crash diets.");
    }

    if (diet && diet !== "" && diet.toLowerCase() !== "none") {
      dos.push(`Adjust your diet to your ${diet} preference with balanced nutrients.`);
    }

    const wellnessTips = [
      "Use breathing exercises or yoga to reduce stress.",
      "Maintain regular sleep patterns and peaceful bedtime routines.",
      "Take breaks to avoid burnout and improve focus.",
      "Stay socially active.",
      "Limit caffeine especially in the afternoon and night."
    ];

    let output = "=== Personalized Dietary & Wellness Guide ===\n\nDo's:\n";
    dos.forEach((item,i) => output += `${i+1}. ${item}\n`);
    output += "\nDon'ts:\n";
    donts.forEach((item,i) => output += `${i+1}. ${item}\n`);
    output += "\nAdditional Mental & Wellness Tips:\n";
    wellnessTips.forEach((item,i) => output += `${i+1}. ${item}\n`);

    return output;
  }

  // Reset button clears all inputs and outputs
  document.getElementById('resetBtn').addEventListener('click', () => {
    ['age', 'weight', 'height', 'diet', 'goalSelect', 'foodQuery'].forEach(id => {
      const elem = document.getElementById(id);
      if (elem.tagName === "SELECT") elem.selectedIndex = 0;
      else elem.value = "";
    });
    ['bmiAdvice', 'nutritionResult', 'dosOutput'].forEach(id => {
      document.getElementById(id).value !== undefined 
        ? document.getElementById(id).value = "" 
        : document.getElementById(id).textContent = "";
    });
  });

  // BMI calculation button event
  document.getElementById('calcBtn').addEventListener('click', () => {
    const age = document.getElementById('age').value.trim();
    const weight = parseFloat(document.getElementById('weight').value);
    const height = parseFloat(document.getElementById('height').value);
    const diet = document.getElementById('diet').value.trim();

    if (!weight || !height || weight <= 0 || height <= 0) {
      alert('Please enter valid weight and height');
      return;
    }

    const bmi = calculateBMI(weight, height);
    const bmiCat = getBMICategory(bmi);

    const detailedAdvice = generateDetailedAdvice(weight, height, bmi, bmiCat, age, diet, "General");

    document.getElementById('bmiAdvice').value = detailedAdvice;
  });

  // Nutrition lookup event
  document.getElementById('searchBtn').addEventListener('click', async () => {
    const food = document.getElementById('foodQuery').value.trim();
    const output = document.getElementById('nutritionResult');

    if (!food) {
      alert('Please enter a food name to search.');
      return;
    }
    output.value = 'Loading nutrition info...';

    try {
      const apiKey = 'evbkpkYjm9qBAe6gXrcAgIhhFechn8Tj3Yd4AuIp';  // Replace this string with your USDA API key
      const response = await fetch(`https://api.nal.usda.gov/fdc/v1/foods/search?api_key=${apiKey}&query=${encodeURIComponent(food)}&pageSize=1`);
      const data = await response.json();
      if (!data.foods || data.foods.length === 0) {
        output.value = 'No nutrition data found.';
        return;
      }
      const item = data.foods[0];
      let nutrients = {};
      item.foodNutrients.forEach(n => {
        const name = n.nutrientName.toLowerCase();
        if (name.includes("energy")) nutrients.Calories = n.value;
        if (name.includes("protein")) nutrients.Protein = n.value;
        if (name.includes("fat")) nutrients.Fat = n.value;
        if (name.includes("carbohydrate")) nutrients.Carbohydrates = n.value;
      });
      let result = `${item.description} (per serving):\n`;
      for (const [key, val] of Object.entries(nutrients)) {
        result += `${key}: ${val}\n`;
      }
      output.value = result;
    } catch (e) {
      output.value = 'Error fetching nutrition data.';
    }
  });

  // Do's & Don'ts button event
  document.getElementById('showDosBtn').addEventListener('click', () => {
    const goal = document.getElementById('goalSelect').value;
    const weight = parseFloat(document.getElementById('weight').value);
    const height = parseFloat(document.getElementById('height').value);
    const diet = document.getElementById('diet').value.trim();

    if (!goal) {
      alert("Please select your weight goal.");
      return;
    }
    if (!weight || !height || weight <= 0 || height <= 0) {
      alert("Please enter valid weight and height for better customization.");
      return;
    }

    const bmi = calculateBMI(weight, height);
    const bmiCat = getBMICategory(bmi);

    const guideText = generateGuide(goal, bmiCat, diet);
    document.getElementById('dosOutput').textContent = guideText;
  });
</script>

</body>
</html>
