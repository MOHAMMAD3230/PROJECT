<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="https://mohammad3230.github.io/PROJECT/favicon.png" type="image/png" sizes="32x32" /> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberGuard AI - Fraud Detection Bot</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom styles for the dark theme and specific elements */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text color */
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .card {
            background-color: #2d3748; /* Slightly lighter dark card background */
            border-radius: 0.75rem; /* Rounded corners */
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .input-field {
            background-color: #4a5568;
            border: 1px solid #6b7280;
            color: #e2e8f0;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            width: 100%;
        }
        .btn-primary {
            background-color: #4299e1; /* Blue */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #3182ce; /* Darker blue on hover */
        }
        .rating-5 { color: #48bb78; } /* Green */
        .rating-4 { color: #9ae6b4; } /* Light Green */
        .rating-3 { color: #ecc94b; } /* Yellow */
        .rating-2 { color: #ed8936; } /* Orange */
        .rating-1 { color: #e53e3e; } /* Red */
        .severity-critical { background-color: #e53e3e; } /* Red */
        .severity-high { background-color: #ed8936; } /* Orange */
        .severity-medium { background-color: #ecc94b; } /* Yellow */
        .severity-low { background-color: #48bb78; } /* Green */
        /* Loading spinner styles */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #4299e1;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">
    <header class="bg-gray-800 shadow-lg py-4">
        <nav class="container flex justify-between items-center">
            <h1 class="text-3xl font-bold text-blue-400">CyberGuard AI</h1>
            <ul class="flex space-x-6">
                <li><a href="#home" class="text-gray-300 hover:text-blue-300 transition duration-300">Home</a></li>
                <li><a href="#domain-analysis" class="text-gray-300 hover:text-blue-300 transition duration-300">Domain Analysis</a></li>
                <li><a href="#yara-detection" class="text-gray-300 hover:text-blue-300 transition duration-300">YARA Detection</a></li>
            </ul>
        </nav>
    </header>
    <main class="container py-8">
        <!-- Home Section -->
        <section id="home" class="text-center mb-16">
            <h2 class="text-5xl font-extrabold text-white mb-6">Detect Cyber Frauds with AI Precision</h2>
            <p class="text-xl text-gray-300 mb-8">Your intelligent bot for real-time cyber threat detection, domain analysis, and proactive security.</p>
            <div class="flex justify-center space-x-4">
                <a href="#domain-analysis" class="btn-primary text-lg font-semibold shadow-lg hover:shadow-xl">Start Domain Scan</a>
            </div>
        </section>
        <!-- Domain Analysis Section -->
        <section id="domain-analysis" class="card mb-16">
            <h3 class="text-3xl font-bold text-blue-400 mb-6">Domain Analysis & Reputation</h3>
            <div class="flex flex-col md:flex-row gap-4 mb-6">
                <input type="text" id="domainInput" placeholder="Enter domain (e.g., example.com)" class="input-field flex-grow">
                <button id="scanDomainBtn" class="btn-primary flex-shrink-0 flex items-center justify-center">
                    <i class="fas fa-search mr-2"></i> Scan Domain
                </button>
            </div>
            <div id="domainAnalysisResults" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Results will be dynamically inserted here -->
                <div class="col-span-full text-center text-gray-400" id="domainAnalysisPlaceholder">
                    Enter a domain and click "Scan Domain" to see results.
                </div>
            </div>
        </section>
        <!-- YARA Signature Detection Section -->
        <section id="yara-detection" class="card mb-16">
            <h3 class="text-3xl font-bold text-blue-400 mb-6">YARA Signature Detection</h3>
            <div class="flex flex-col gap-4 mb-6">
                <textarea id="yaraContentInput" rows="6" placeholder="Paste file content or text to scan for YARA signatures..." class="input-field"></textarea>
                <button id="scanYaraBtn" class="btn-primary flex items-center justify-center">
                    <i class="fas fa-fingerprint mr-2"></i> Scan with YARA
                </button>
            </div>
            <div id="yaraDetectionResults" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Results will be dynamically inserted here -->
                <div class="col-span-full text-center text-gray-400" id="yaraDetectionPlaceholder">
                    Paste content and click "Scan with YARA" to find matches.
                </div>
            </div>
        </section>
        <!-- Malicious Activity Policies Section -->
        <section id="malicious-activity" class="card mb-16">
            <h3 class="text-3xl font-bold text-blue-400 mb-6">Malicious Activity Policies & Detections</h3>
            <p class="text-gray-300 mb-6">Our system identifies and categorizes malicious activities based on predefined policies, ensuring targeted and effective responses across various threat types.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="card bg-gray-700">
                    <h4 class="text-xl font-semibold mb-2 text-white"><i class="fas fa-bug mr-2 text-red-400"></i> Malware Detection</h4>
                    <p class="text-gray-300 text-sm">Identifies viruses, ransomware, spyware, and other malicious software using YARA signatures and behavioral analysis.</p>
                </div>
                <div class="card bg-gray-700">
                    <h4 class="text-xl font-semibold mb-2 text-white"><i class="fas fa-dice mr-2 text-yellow-400"></i> Gambling Activities</h4>
                    <p class="text-gray-300 text-sm">Detects unauthorized or illicit online gambling patterns and associated domains.</p>
                </div>
                <div class="card bg-gray-700">
                    <h4 class="text-xl font-semibold mb-2 text-white"><i class="fas fa-fish mr-2 text-orange-400"></i> Phishing Attempts</h4>
                    <p class="text-gray-300 text-sm">Uncovers BEC, credential capture, smishing, and QR code phishing through email and domain analysis.</p>
                </div>
                <div class="card bg-gray-700">
                    <h4 class="text-xl font-semibold mb-2 text-white"><i class="fas fa-user-friends mr-2 text-purple-400"></i> Social Engineering</h4>
                    <p class="text-gray-300 text-sm">Flags baiting, scareware, and pretexting using behavioral analytics and unusual activity patterns.</p>
                </div>
                <div class="card bg-gray-700">
                    <h4 class="text-xl font-semibold mb-2 text-white"><i class="fas fa-mask mr-2 text-pink-400"></i> Adult Content</h4>
                    <p class="text-gray-300 text-sm">Identifies explicit or inappropriate content in streams via image recognition and content filtering.</p>
                </div>
                <div class="card bg-gray-700">
                    <h4 class="text-xl font-semibold mb-2 text-white"><i class="fas fa-sack-dollar mr-2 text-green-400"></i> Get Rich Quick Schemes</h4>
                    <p class="text-gray-300 text-sm">Detects financial fraud like Ponzi schemes through transaction analysis and network graph analysis.</p>
                </div>
            </div>
            <h4 class="text-2xl font-bold text-white mb-4">Recent Detections Log (Simulated)</h4>
            <div id="detectionLog" class="space-y-4">
                <!-- Simulated detection logs will be inserted here -->
                <div class="card bg-gray-800 flex items-center justify-between">
                    <div>
                        <span class="text-lg font-semibold text-orange-400">Phishing Alert:</span> <span class="text-gray-300">Suspicious email from "support@micros0ft.com" detected.</span>
                    </div>
                    <span class="px-3 py-1 rounded-full text-sm font-semibold severity-high">High</span>
                </div>
                <div class="card bg-gray-800 flex items-center justify-between">
                    <div>
                        <span class="text-lg font-semibold text-red-400">Malware Detected:</span> <span class="text-gray-300">Potential ransomware activity on endpoint XYZ.</span>
                    </div>
                    <span class="px-3 py-1 rounded-full text-sm font-semibold severity-critical">Critical</span>
                </div>
                <div class="card bg-gray-800 flex items-center justify-between">
                    <div>
                        <span class="text-lg font-semibold text-green-400">Adult Content:</span> <span class="text-gray-300">Content filtered from user session.</span>
                    </div>
                    <span class="px-3 py-1 rounded-full text-sm font-semibold severity-low">Low</span>
                </div>
            </div>
        </section>
        
        
    </main>
    <footer class="bg-gray-800 py-6 text-center text-gray-400">
        <p>&copy; 2025 CyberGuard AI. All rights reserved.</p>
    </footer>
    <script>
        // Helper function to get a random rating and corresponding class
        function getRandomRating() {
            const rating = Math.floor(Math.random() * 5) + 1;
            let colorClass = '';
            switch (rating) {
                case 5: colorClass = 'rating-5'; break;
                case 4: colorClass = 'rating-4'; break;
                case 3: colorClass = 'rating-3'; break;
                case 2: colorClass = 'rating-2'; break;
                case 1: colorClass = 'rating-1'; break;
            }
            return { rating, colorClass };
        }
        // Helper function to get a random severity and corresponding class
        function getRandomSeverity() {
            const severities = ['Critical', 'High', 'Medium', 'Low'];
            const randomSeverity = severities[Math.floor(Math.random() * severities.length)];
            let severityClass = '';
            switch (randomSeverity) {
                case 'Critical': severityClass = 'severity-critical'; break;
                case 'High': severityClass = 'severity-high'; break;
                case 'Medium': severityClass = 'severity-medium'; break;
                case 'Low': severityClass = 'severity-low'; break;
            }
            return { severity: randomSeverity, severityClass };
        }
        // --- Domain Analysis Logic ---
        document.getElementById('scanDomainBtn').addEventListener('click', () => {
            const domain = document.getElementById('domainInput').value.trim();
            const resultsDiv = document.getElementById('domainAnalysisResults');
            resultsDiv.innerHTML = ''; // Clear previous results
            const domainAnalysisPlaceholder = document.getElementById('domainAnalysisPlaceholder');
            if (domainAnalysisPlaceholder) {
                domainAnalysisPlaceholder.classList.add('hidden');
            }
            if (!domain) {
                resultsDiv.innerHTML = '<p class="col-span-full text-red-400 text-center">Please enter a domain to scan.</p>';
                return;
            }
            // Simulate API call delay
            resultsDiv.innerHTML = '<div class="col-span-full flex justify-center items-center"><div class="spinner"></div><span class="ml-2 text-gray-400">Scanning domain...</span></div>';
            setTimeout(() => {
                const { rating: overallRating, colorClass: overallColor } = getRandomRating();
                const { rating: emailAuthRating, colorClass: emailAuthColor } = getRandomRating();
                const { rating: blacklistRating, colorClass: blacklistColor } = getRandomRating();
                const { rating: domainAgeRating, colorClass: domainAgeColor } = getRandomRating();
                const { rating: ipRating, colorClass: ipColor } = getRandomRating();
                const domainData = {
                    overallReputation: overallRating,
                    emailAuth: emailAuthRating > 2 ? 'All Pass/Configured' : 'Some Issues',
                    blacklistStatus: blacklistRating > 1 ? 'Clean' : 'Listed on major lists',
                    domainAge: domainAgeRating === 5 ? '>5 years' : (domainAgeRating === 3 ? '1-5 years' : '<1 year (newly registered)'),
                    associatedIPs: [
                        { ip: '192.168.1.1', reputation: getRandomRating().rating },
                        { ip: '10.0.0.5', reputation: getRandomRating().rating },
                        { ip: '172.16.0.10', reputation: getRandomRating().rating }
                    ],
                    lastScanned: new Date().toLocaleString(),
                    source: 'Simulated Threat Intelligence Feeds'
                };
                resultsDiv.innerHTML = `
                    <div class="card bg-gray-700">
                        <h4 class="text-xl font-semibold mb-2 text-white">Overall Reputation</h4>
                        <p class="text-3xl font-bold ${overallColor}">${domainData.overallReputation}/5</p>
                        <p class="text-gray-400">Aggregated trustworthiness score.</p>
                    </div>
                    <div class="card bg-gray-700">
                        <h4 class="text-xl font-semibold mb-2 text-white">Email Authentication</h4>
                        <p class="text-2xl font-bold ${emailAuthColor}">${domainData.emailAuth}</p>
                        <p class="text-gray-400">DMARC, SPF, DKIM status.</p>
                    </div>
                    <div class="card bg-gray-700">
                        <h4 class="text-xl font-semibold mb-2 text-white">Blacklist Status</h4>
                        <p class="text-2xl font-bold ${blacklistColor}">${domainData.blacklistStatus}</p>
                        <p class="text-gray-400">Presence on major blacklists.</p>
                    </div>
                    <div class="card bg-gray-700">
                        <h4 class="text-xl font-semibold mb-2 text-white">Domain Age</h4>
                        <p class="text-2xl font-bold ${domainAgeColor}">${domainData.domainAge}</p>
                        <p class="text-gray-400">Age of domain registration.</p>
                    </div>
                    <div class="card bg-gray-700 col-span-1 md:col-span-2 lg:col-span-1">
                        <h4 class="text-xl font-semibold mb-2 text-white">Associated IP Addresses</h4>
                        <ul class="list-disc list-inside text-gray-300">
                            ${domainData.associatedIPs.map(ip => `<li class="flex justify-between items-center">${ip.ip} <span class="${getRandomRating().colorClass}">${ip.reputation}/5</span></li>`).join('')}
                        </ul>
                        <p class="text-gray-400 mt-2">Stability and reputation of hosting IPs.</p>
                    </div>
                    <div class="card bg-gray-700">
                        <h4 class="text-xl font-semibold mb-2 text-white">Last Scanned</h4>
                        <p class="text-gray-300">${domainData.lastScanned}</p>
                        <p class="text-gray-400">Data recency.</p>
                    </div>
                    <div class="card bg-gray-700 col-span-full">
                        <h4 class="text-xl font-semibold mb-2 text-white">Source of Reputation Data</h4>
                        <p class="text-gray-300">${domainData.source}</p>
                    </div>
                `;
            }, 1500);
        });
        // --- YARA Signature Detection Logic ---
        document.getElementById('scanYaraBtn').addEventListener('click', () => {
            const content = document.getElementById('yaraContentInput').value.trim();
            const resultsDiv = document.getElementById('yaraDetectionResults');
            resultsDiv.innerHTML = ''; // Clear previous results
            const yaraDetectionPlaceholder = document.getElementById('yaraDetectionPlaceholder');
            if (yaraDetectionPlaceholder) {
                yaraDetectionPlaceholder.classList.add('hidden');
            }
            if (!content) {
                resultsDiv.innerHTML = '<p class="col-span-full text-red-400 text-center">Please paste content to scan.</p>';
                return;
            }
            resultsDiv.innerHTML = '<div class="col-span-full flex justify-center items-center"><div class="spinner"></div><span class="ml-2 text-gray-400">Scanning with YARA...</span></div>';
            setTimeout(() => {
                const mockYARAMatches = [];
                const commonMalwareStrings = ['evil.exe', 'malicious_payload', 'trojan_dropper', 'phishing_link', 'ransomware_note'];
                let foundMatch = false;
                for (const str of commonMalwareStrings) {
                    if (content.toLowerCase().includes(str.toLowerCase())) {
                        foundMatch = true;
                        const { rating: confidence, colorClass: confidenceColor } = getRandomRating();
                        mockYARAMatches.push({
                            ruleName: `Generic_${str.replace(/[^a-zA-Z0-9]/g, '_')}_Detection`,
                            description: `Identified a string commonly associated with ${str.includes('phishing') ? 'phishing' : (str.includes('ransomware') ? 'ransomware' : 'malware')}.`,
                            matchedStrings: `"${str}"`,
                            target: `Simulated_File_${Math.random().toFixed(4)}.txt`,
                            matchContext: `Offset: 0x${Math.floor(Math.random() * 10000).toString(16)}, Bytes: ...`,
                            author: 'CyberGuard AI Internal Rules',
                            timestamp: new Date().toLocaleString(),
                            confidence: confidence,
                            confidenceColor: confidenceColor
                        });
                    }
                }
                if (!foundMatch) {
                    resultsDiv.innerHTML = '<p class="col-span-full text-green-400 text-center">No YARA signatures detected in the provided content.</p>';
                    return;
                }
                resultsDiv.innerHTML = mockYARAMatches.map(match => `
                    <div class="card bg-gray-700">
                        <h4 class="text-xl font-semibold mb-2 text-white">Rule: ${match.ruleName}</h4>
                        <p class="text-gray-300 mb-2">${match.description}</p>
                        <p class="text-gray-400 text-sm"><strong>Matched:</strong> ${match.matchedStrings}</p>
                        <p class="text-gray-400 text-sm"><strong>Target:</strong> ${match.target}</p>
                        <p class="text-gray-400 text-sm"><strong>Confidence:</strong> <span class="${match.confidenceColor}">${match.confidence}/5</span></p>
                        <p class="text-gray-400 text-sm"><strong>Detected:</strong> ${match.timestamp}</p>
                    </div>
                `).join('');
            }, 1500);
        });
        // --- IOC Management Logic ---
        // Helper function to escape HTML special characters
        function escapeHTML(str) {
            return str.replace(/[&<>"']/g, function (m) {
                switch (m) {
                    case '&': return '&amp;';
                    case '<': return '&lt;';
                    case '>': return '&gt;';
                    case '"': return '&quot;';
                    case "'": return '&#39;';
                    default: return m;
                }
            });
        }
        document.getElementById('showAssociationsBtn').addEventListener('click', () => {
            const primaryInput = document.getElementById('iocInput').value.trim();
            const iocCardsContainer = document.getElementById('iocCardsContainer');
            const domainAssociationsList = document.getElementById('associationsList');
            const domainAssociationsPlaceholder = document.getElementById('domainAssociationsPlaceholder');
            const iocPlaceholder = document.getElementById('iocPlaceholder'); // Get reference to the placeholder *before* clearing parent
            // Clear previous results and hide placeholders/lists
            if (iocCardsContainer) {
                iocCardsContainer.innerHTML = ''; // This will remove iocPlaceholder
            }
            if (domainAssociationsList) {
                domainAssociationsList.innerHTML = ''; // Clear previous associations
                domainAssociationsList.classList.add('hidden');
            }
            // Hide the domain associations placeholder if it exists
            if (domainAssociationsPlaceholder) {
                domainAssociationsPlaceholder.classList.add('hidden');
            }
            if (!primaryInput) {
                if (iocCardsContainer) {
                    iocCardsContainer.innerHTML = '<p class="col-span-full text-red-400 text-center">Please enter a primary domain/IP.</p>';
                }
                if (domainAssociationsPlaceholder) {
                    domainAssociationsPlaceholder.classList.remove('hidden'); // Show it again
                    domainAssociationsPlaceholder.textContent = 'Associations for the queried domain/IP will appear here.';
                }
                return;
            }
            // Show loading indicators
            if (iocCardsContainer) {
                iocCardsContainer.innerHTML = '<div class="col-span-full flex justify-center items-center"><div class="spinner"></div><span class="ml-2 text-gray-400">Fetching IOCs...</span></div>';
            }
            if (domainAssociationsPlaceholder) {
                domainAssociationsPlaceholder.textContent = 'Fetching associations...';
                domainAssociationsPlaceholder.classList.remove('hidden'); // Make sure it's visible with loading text
            }
            setTimeout(() => {
                const mockIOCs = [
                    {
                        type: 'IP Address', value: '192.0.2.1',
                        severity: getRandomSeverity(),
                        firstSeen: '2024-01-15 10:00 UTC', lastSeen: '2025-07-24 14:30 UTC',
                        categories: ['Phishing', 'Spam'],
                        confidence: getRandomRating(),
                        geolocation: 'Russia', asn: 'AS12345',
                        source: 'ThreatFeedX',
                    },
                    {
                        type: 'Domain', value: 'malicious-domain.xyz',
                        severity: getRandomSeverity(),
                        firstSeen: '2024-03-01 08:00 UTC', lastSeen: '2025-07-24 15:10 UTC',
                        categories: ['Malware', 'C2'],
                        confidence: getRandomRating(),
                        geolocation: 'Germany', asn: 'AS67890',
                        source: 'VirusTotal',
                    },
                    {
                        type: 'File Hash (SHA256)', value: 'a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890',
                        severity: getRandomSeverity(),
                        firstSeen: '2025-06-20 09:00 UTC', lastSeen: '2025-07-24 16:00 UTC',
                        categories: ['Ransomware'],
                        confidence: getRandomRating(),
                        geolocation: 'N/A', asn: 'N/A',
                        source: 'Internal EDR',
                    },
                    {
                        type: 'URL', value: 'http://phishing.example.com/login',
                        severity: getRandomSeverity(),
                        firstSeen: '2025-07-10 11:00 UTC', lastSeen: '2025-07-24 17:00 UTC',
                        categories: ['Credential Capture'],
                        confidence: getRandomRating(),
                        geolocation: 'USA', asn: 'AS98765',
                        source: 'OSINT Feed',
                    }
                ];
                const mockAssociations = [
                    `Subdomain: sub.${primaryInput}`,
                    `Related IP: 203.0.113.45`,
                    `Associated Malware Family: Zeus`,
                    `Hosting Provider: EvilHost Inc.`,
                    `Linked Phishing Campaign ID: PHISH-2025-07-ABC`,
                ];
                if (iocCardsContainer) {
                    if (mockIOCs.length > 0) {
                        iocCardsContainer.innerHTML = mockIOCs.map(ioc => `
                            <div class="card bg-gray-700 p-4 relative overflow-hidden">
                                <div class="absolute top-0 left-0 w-full h-2 ${ioc.severity.severityClass}"></div>
                                <h4 class="text-xl font-semibold mb-2 text-white">${ioc.type}: <span class="text-blue-300">${ioc.value}</span></h4>
                                <p class="text-gray-400 text-sm mb-1"><strong>Severity:</strong> <span class="px-2 py-0.5 rounded-full text-xs font-semibold ${ioc.severity.severityClass}">${ioc.severity.severity}</span></p>
                                <p class="text-gray-400 text-sm mb-1"><strong>Confidence:</strong> <span class="${ioc.confidence.colorClass}">${ioc.confidence.rating}/5</span></p>
                                <p class="text-gray-400 text-sm mb-1"><strong>First Seen:</strong> ${ioc.firstSeen}</p>
                                <p class="text-gray-400 text-sm mb-1"><strong>Last Seen:</strong> ${ioc.lastSeen}</p>
                                <p class="text-gray-400 text-sm mb-1"><strong>Categories:</strong> ${ioc.categories.join(', ')}</p>
                                <p class="text-gray-400 text-sm mb-1"><strong>Geolocation:</strong> ${ioc.geolocation}</p>
                                <p class="text-gray-400 text-sm mb-1"><strong>ASN:</strong> ${ioc.asn}</p>
                                <p class="text-gray-400 text-sm mb-4"><strong>Source:</strong> ${ioc.source}</p>
                                <div class="flex space-x-2">
                                    <button class="bg-red-600 hover:bg-red-700 text-white text-sm px-3 py-1 rounded-md transition duration-300"><i class="fas fa-ban mr-1"></i> Block</button>
                                    <button class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-3 py-1 rounded-md transition duration-300"><i class="fas fa-magnifying-glass mr-1"></i> Investigate</button>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        iocCardsContainer.innerHTML = `
                            <div class="col-span-full text-center text-gray-400" id="iocPlaceholder">
                                No IOCs found for "${escapeHTML(primaryInput)}".
                            </div>
                        `;
                    }
                }
                if (domainAssociationsList && domainAssociationsPlaceholder) {
                    if (mockAssociations.length > 0) {
                        domainAssociationsList.innerHTML = mockAssociations.map(assoc => `<li>${escapeHTML(assoc)}</li>`).join('');
                        domainAssociationsList.classList.remove('hidden'); // Show the list
                        domainAssociationsPlaceholder.classList.add('hidden'); // Hide the placeholder
                    } else {
                        domainAssociationsPlaceholder.classList.remove('hidden'); // Show the placeholder
                        domainAssociationsPlaceholder.textContent = 'No associations found for this input.';
                        domainAssociationsList.classList.add('hidden'); // Ensure list is hidden if no associations
                    }
                }
            }, 2000);
        });
        // --- Threat Intelligence Logic (using Gemini API) ---
        document.getElementById('getThreatIntelBtn').addEventListener('click', async () => {
            const query = document.getElementById('threatIntelQuery').value.trim();
            const threatIntelOutput = document.getElementById('threatIntelOutput');
            const threatIntelPlaceholder = document.getElementById('threatIntelPlaceholder');
            const threatIntelContent = document.getElementById('threatIntelContent');
            const threatIntelSpinner = document.getElementById('threatIntelSpinner');
            if (threatIntelPlaceholder) {
                threatIntelPlaceholder.classList.add('hidden');
            }
            if (threatIntelContent) {
                threatIntelContent.classList.add('hidden');
                threatIntelContent.innerHTML = ''; // Clear previous content
            }
            if (!query) {
                if (threatIntelPlaceholder) {
                    threatIntelPlaceholder.classList.remove('hidden');
                    threatIntelPlaceholder.textContent = 'Please enter a query for threat intelligence.';
                }
                return;
            }
            if (threatIntelSpinner) {
                threatIntelSpinner.classList.remove('hidden');
            }
            try {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: `Provide a concise, simulated real-time threat intelligence update or analysis for the query: "${query}". Focus on recent trends, common attack vectors, and potential impacts. Keep it under 200 words.` }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; // Canvas will provide this
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    if (threatIntelContent) {
                        threatIntelContent.innerHTML = `<p>${text}</p><p class="text-gray-500 text-sm mt-4"><em>Source: Simulated Real-time AI Intelligence (${new Date().toLocaleString()})</em></p>`;
                        threatIntelContent.classList.remove('hidden');
                    }
                } else {
                    if (threatIntelContent) {
                        threatIntelContent.innerHTML = '<p class="text-red-400">Failed to retrieve threat intelligence. Please try again.</p>';
                        threatIntelContent.classList.remove('hidden');
                    }
                }
            } catch (error) {
                console.error('Error fetching threat intelligence:', error);
                if (threatIntelContent) {
                    threatIntelContent.innerHTML = '<p class="text-red-400">An error occurred while fetching threat intelligence. Check console for details.</p>';
                    threatIntelContent.classList.remove('hidden');
                }
            } finally {
                if (threatIntelSpinner) {
                    threatIntelSpinner.classList.add('hidden');
                }
            }
        });
        // Smooth scrolling for navigation
        document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>
