<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My_Music</title>
<link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet" />
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
  *, *::before, *::after { box-sizing: border-box; }
  html, body {
    margin: 0;
    padding: 0;
    height: auto;       /* allow natural height */
    overflow-y: auto;   /* enable vertical scroll */
    font-family: 'Inter', sans-serif;
    background: #05070A;
    color: #d8f0ff;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    user-select: none;
  }
  canvas#matrix {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
    background: #05070A;
    image-rendering: pixelated;
    pointer-events: none;
  }
  #app {
    position: relative;
    z-index: 10;
    max-width: 960px;
    margin: 2rem auto 3rem;
    background: rgba(15, 25, 42, 0.95);
    border-radius: 1rem;
    box-shadow: 0 0 40px rgba(40, 130, 230, 0.6);
    min-height: 80vh;
    display: flex;
    flex-direction: column;
    font-feature-settings: "liga" 0, "calt" 0;
  }
  header {
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #1a2c59;
    background: #06172F;
  }
  .logo {
    font-weight: 800;
    font-size: 2.8rem;
    letter-spacing: 5px;
    color: #4dabf7;
    text-shadow: 0 0 15px #4dabf7cc;
    user-select: none;
    font-family: 'Share Tech Mono', monospace;
  }
  form#formAuth {
    display: flex;
    align-items: center;
    gap: 12px;
    max-width: 720px;
  }
  form#formAuth > * {
    font-family: inherit;
  }
  form#formAuth input[type="text"],
  form#formAuth input[type="password"] {
    width: 160px;
    padding: 8px 10px;
    font-size: 1rem;
    border-radius: 8px;
    border: 1px solid #2c4d7f;
    background-color: #091C3D;
    color: #A9CBFF;
    box-shadow: inset 0 0 6px #2055bfaa;
    transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease, color 0.3s ease;
    caret-color: #82c7ff;
  }
  form#formAuth input[type="text"]:focus,
  form#formAuth input[type="password"]:focus {
    outline: none;
    border-color: #69ABFF;
    box-shadow: 0 0 12px #69ABFFbb inset;
    background-color: #14325B;
    color: #DCEEFF;
  }
  form#formAuth button {
    min-width: 110px;
    padding: 10px;
    font-size: 1rem;
    border-radius: 8px;
    border: none;
    background: linear-gradient(45deg, #4dabf7, #0f68c3);
    color: white;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 3px 8px rgb(40 130 230 / 0.6);
    transition: background 0.3s ease;
  }
  form#formAuth button:hover:not(:disabled), form#formAuth button:focus-visible:not(:disabled) {
    background: linear-gradient(45deg, #7fbfff, #3f7ed6);
    outline: none;
  }
  form#formAuth button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  form#formAuth button#btnSignOut {
    background: transparent;
    color: #69ABFF;
    font-weight: 600;
    border: none;
    cursor: pointer;
    padding: 8px 12px;
    box-shadow: none;
    transition: color 0.3s ease;
  }
  form#formAuth button#btnSignOut:hover,
  form#formAuth button#btnSignOut:focus-visible {
    color: #92BFFF;
    outline: none;
  }
  form#formAuth button#btnSwitchAuth {
    background: transparent;
    color: #69ABFF;
    font-weight: 600;
    border: none;
    cursor: pointer;
    padding: 8px 12px;
    box-shadow: none;
    transition: color 0.3s ease;
  }
  form#formAuth button#btnSwitchAuth:hover,
  form#formAuth button#btnSwitchAuth:focus-visible {
    color: #92BFFF;
    outline: none;
  }
  #loginMsg {
    margin-left: 16px;
    font-weight: 600;
    font-size: 1rem;
    min-width: 180px;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  nav#primaryTabs {
    display: flex;
    justify-content: center;
    border-bottom: 1px solid #1a2c59;
    background: #06172F;
    user-select: none;
    box-shadow: inset 0 -4px 12px #4dabf799;
    margin-top: 1rem;
  }
  nav#primaryTabs button {
    padding: 1rem 2rem;
    background: transparent;
    border: none;
    color: #678cb8aa;
    font-weight: 600;
    font-size: 1.25rem;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    letter-spacing: 1.5px;
    transition: all 0.3s ease;
    user-select: none;
  }
  nav#primaryTabs button[aria-selected="true"] {
    font-weight: 700;
    color: #9dc7ff;
    border-bottom-color: #74abffcc;
    cursor: default;
    text-shadow: 0 0 10px #74abffbb;
  }
  nav#primaryTabs button:focus-visible {
    outline-offset: 2px;
    outline: 2px solid #74abffcc;
  }
  nav#primaryTabs button:disabled {
    cursor: not-allowed;
    color: #426485aa;
  }
  .searchGroup {
    max-width: 720px;
    margin: 2rem auto 0;
    display: flex;
    gap: 1rem;
  }
  input[type="search"] {
    flex-grow: 1;
    padding: 12px 20px;
    font-size: 1.3rem;
    border-radius: 8px 0 0 8px;
    border: 1px solid #324c7d;
    background-color: #19305a;
    color: #a9cbff;
    caret-color: #6daeff;
    font-weight: 600;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    font-family: 'Inter', sans-serif;
  }
  input[type="search"]:focus {
    outline: none;
    border-color: #6daeff;
    box-shadow: 0 0 20px #6daeffaa inset;
    background-color: #214787cc;
    color: #d7e7ff;
  }
  button[type="submit"] {
    font-size: 1.3rem;
    padding: 15px 36px;
    border-radius:0 8px 8px 0;
    border: 1px solid #4574c8;
    background: linear-gradient(45deg,#4b8fff,#266dff);
    box-shadow: 0 5px 15px rgb(47 94 255 / 60%);
    font-weight: 700;
    color: #f5f6fa;
    cursor: pointer;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    user-select: none;
  }
  button[type="submit"]:disabled {
    opacity: 0.4;
    cursor: default;
  }
  button[type="submit"]:hover:not(:disabled),
  button[type="submit"]:focus-visible:not(:disabled) {
    background: linear-gradient(45deg,#65a7ff,#3b5cf4);
    box-shadow: 0 8px 25px rgb(85 156 255 / 80%);
    outline: none;
  }
  ul.songList {
    max-width: 720px;
    margin: 2rem auto;
    padding: 0;
    background: #0e1e3dcc;
    border-radius: 12px;
    box-shadow: 0 0 30px #164f91aa;
    border: 1px solid #264471cc;
    max-height: 400px;
    overflow-y: auto;
    font-family: 'Inter', sans-serif;
  }
  ul.songList li {
    display: grid;
    grid-template-columns: 56px 1fr 180px 140px;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid #174f95;
    color: #a8cbffcc;
    font-weight: 600;
    letter-spacing: 0.02em;
  }
  ul.songList li:last-child {
    border-bottom: none;
  }
  ul.songList img {
    width: 56px;
    height: 56px;
    object-fit: cover;
    border-radius: 8px;
    box-shadow: 0 0 16px #4dabf7aa;
    user-select: none;
  }
  .title {
    font-weight: 700;
    font-size: 1.1rem;
    color: #a4d9ffcc;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    user-select: text;
  }
  .subtitle {
    font-size: 0.85rem;
    color: #6995c6cc;
    font-weight: 500;
    user-select: text;
  }
  audio {
    width: 140px;
    border-radius: 10px;
    outline: none;
    box-shadow: 0 0 8px #3c76d4a0;
    user-select: none;
  }
  .actions {
    display: flex;
    gap: 10px;
  }
  button.btnAction {
    background: transparent;
    border: 2px solid #6ba7ffcc;
    color: #a7d1ffcc;
    font-weight: 600;
    padding: 8px 16px;
    font-size: 0.9rem;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    user-select: none;
  }
  button.btnAction:hover, button.btnAction:focus-visible {
    background: #3e7de0cc;
    border-color: #85b0ffcc;
    color: #d2e5fff0;
    outline: none;
  }
  button.btnAction:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
  @media (max-width: 720px) {
    header {
      flex-direction: column;
      align-items: flex-start;
      gap: 12px;
    }
    form#formAuth {
      justify-content: center;
      flex-wrap: wrap;
      max-width: 100%;
    }
    form#formAuth input {
      width: 100%;
      font-size: 1.2rem;
    }
    form#formAuth button {
      width: 49%;
      margin-bottom: 12px;
      font-size: 1.2rem;
    }
    nav#primaryTabs {
      flex-wrap: wrap;
    }
    nav#primaryTabs button {
      flex: 1 1 100%;
      font-size: 1.5rem;
      padding: 12px 0;
      text-align: center;
    }
    ul.songList li {
      grid-template-columns: 50px 1fr 140px 120px;
    }
    audio {
      width: 120px;
    }
  }
</style>
</head>
<body>
  <canvas id="matrix"></canvas>

  <div id="app" role="application" aria-label="Premium matrix music player">

    <header>
      <div class="logo" tabindex="0" aria-label="Site Logo, My Music">My_Music</div>
      <form id="formAuth" aria-label="Authentication form">
        <input type="text" id="inputUsername" aria-label="Username" placeholder="Username" autocomplete="username" required />
        <input type="password" id="inputPassword" aria-label="Password" placeholder="Password" autocomplete="current-password" required />
        <button id="btnAuth" aria-live="polite">Sign In</button>
        <button type="button" id="btnSwitchAuth" aria-live="polite">Create new account</button>
        <button type="button" id="btnSignOut" aria-live="polite" style="display:none;">Sign Out</button>
        <span id="loginMsg" aria-live="polite" aria-atomic="true"></span>
      </form>
    </header>

    <nav id="primaryTabs" role="tablist" aria-label="Primary navigation tabs">
      <button class="tab" id="tabOnline" role="tab" aria-selected="true" aria-controls="panelOnline" tabindex="0" disabled>Online</button>
      <button class="tab" id="tabOffline" role="tab" aria-selected="false" aria-controls="panelOffline" tabindex="-1" disabled>Offline</button>
      <button class="tab" id="tabPlaylist" role="tab" aria-selected="false" aria-controls="panelPlaylist" tabindex="-1" disabled>Playlist</button>
    </nav>

    <section id="panelOnline" role="tabpanel" aria-labelledby="tabOnline" tabindex="0" hidden>
      <div class="searchGroup" style="margin-top:1rem;">
        <input type="search" id="searchInput" aria-label="Search songs and artists" placeholder="Search songs or artists" disabled />
        <button id="searchBtn" disabled>Search</button>
      </div>
      <ul id="onlineList" class="songList" aria-label="Online songs list" tabindex="0" style="margin-top:1rem;"></ul>
    </section>

    <section id="panelOffline" role="tabpanel" aria-labelledby="tabOffline" tabindex="0" hidden>
      <nav role="tablist" aria-label="Offline file categories" class="subTabs" style="max-width:720px; margin:1rem auto;">
        <button class="subTab" aria-selected="true" tabindex="0" role="tab" disabled>All Files</button>
      </nav>
      <label for="folderUpload" tabindex="0" aria-label="Upload music folder" style="cursor:pointer;">üìÅ Upload Folder</label>
      <input type="file" id="folderUpload" webkitdirectory directory multiple disabled aria-label="Upload music folder" />
      <input type="search" id="offlineSearch" placeholder="Filter downloaded songs" aria-label="Filter offline songs" disabled style="margin: 0.8rem auto; display: block; max-width: 720px; width: calc(100% - 2rem);" />
      <button id="clearOfflineBtn" disabled style="display: block; margin: 1rem auto;">Clear All</button>
      <ul id="offlineList" class="songList" aria-label="Offline songs list" tabindex="0"></ul>
    </section>

    <section id="panelPlaylist" role="tabpanel" aria-labelledby="tabPlaylist" tabindex="0" hidden>
      <button id="clearPlaylistBtn" style="margin-bottom: 16px;">Clear Playlist</button>
      <ul id="playlistList" class="songList" aria-label="Playlist songs list" tabindex="0"></ul>
    </section>

<script>
(() => {
  const matrix = document.getElementById("matrix");
  const ctx = matrix.getContext("2d");
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789Ôº†ÔºÉÔºÑÔºÖÔºÜÔºä+=?_abcdefghijklmnopqrstuvwxyz".split("");
  const fontSize = 16;
  let columns, drops;

  function resize() {
    matrix.width = window.innerWidth;
    matrix.height = window.innerHeight;
    columns = Math.floor(matrix.width / fontSize);
    drops = new Array(columns).fill(0).map(() => Math.floor(Math.random() * (matrix.height / fontSize)));
  }

  let lastTimestamp = 0;
  const fps = 15;
  const interval = 1000 / fps;

  function drawMatrix(timestamp) {
    if (!lastTimestamp) lastTimestamp = timestamp;
    const elapsed = timestamp - lastTimestamp;
    if (elapsed > interval) {
      ctx.fillStyle = "rgba(5,7,10,0.1)";
      ctx.fillRect(0, 0, matrix.width, matrix.height);
      ctx.fillStyle = "#8fcfff";
      ctx.font = `${fontSize}px 'Share Tech Mono', monospace`;
      ctx.textBaseline = "top";

      for (let i = 0; i < columns; i++) {
        const char = chars[Math.floor(Math.random() * chars.length)];
        const x = i * fontSize;
        const y = drops[i] * fontSize;
        ctx.fillText(char, x, y);
        if (y > matrix.height && Math.random() > 0.975) drops[i] = 0;
        else drops[i]++;
      }
      lastTimestamp = timestamp;
    }
    requestAnimationFrame(drawMatrix);
  }

  resize();
  window.addEventListener("resize", resize);
  requestAnimationFrame(drawMatrix);

  const formAuth = document.getElementById("formAuth"),
        inputUsername = document.getElementById("inputUsername"),
        inputPassword = document.getElementById("inputPassword"),
        btnAuth = document.getElementById("btnAuth"),
        btnSwitchAuth = document.getElementById("btnSwitchAuth"),
        btnSignOut = document.getElementById("btnSignOut"),
        loginMsg = document.getElementById("loginMsg"),
        tabs = [...document.querySelectorAll(".tab")],
        panels = {
          online: document.getElementById("panelOnline"),
          offline: document.getElementById("panelOffline"),
          playlist: document.getElementById("panelPlaylist"),
        },
        searchInput = document.getElementById("searchInput"),
        searchBtn = document.getElementById("searchBtn"),
        onlineList = document.getElementById("onlineList"),
        folderUpload = document.getElementById("folderUpload"),
        offlineSearch = document.getElementById("offlineSearch"),
        clearOfflineBtn = document.getElementById("clearOfflineBtn"),
        offlineList = document.getElementById("offlineList"),
        clearPlaylistBtn = document.getElementById("clearPlaylistBtn"),
        playlistList = document.getElementById("playlistList");

  const users = { user: "password" };
  let onlineSongs = [],
      offlineFiles = [],
      playlist = JSON.parse(localStorage.getItem("playlist") || "[]");

  function escapeHTML(str) {
    return String(str).replace(/[&<>'"`]/g, function (m) {
      return ({
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        "'": '&#39;',
        '"': '&quot;',
        '`': '&#96;'
      })[m];
    });
  }
  let isSignup = false;

  function disableTabs(disabled = true) {
    tabs.forEach(tab => {
      tab.disabled = disabled;
      if (disabled) {
        tab.setAttribute("aria-disabled", "true");
        tab.style.cursor = "not-allowed";
        tab.style.color = "#426485aa";
      } else {
        tab.removeAttribute("aria-disabled");
        tab.style.cursor = "pointer";
        tab.style.color = "";
      }
    });
  }
  disableTabs(true);

  function switchTab(name) {
    Object.entries(panels).forEach(([key, panel]) => panel.hidden = key !== name);
    tabs.forEach(tab => {
      const selected = tab.id === "tab" + name.charAt(0).toUpperCase() + name.slice(1);
      tab.setAttribute("aria-selected", selected);
      tab.tabIndex = selected ? 0 : -1;
    });
    panels[name].focus();
  }

  btnSwitchAuth.addEventListener("click", () => {
    isSignup = !isSignup;
    loginMsg.textContent = "";
    if (isSignup) {
      btnAuth.textContent = "Sign Up";
      btnSwitchAuth.textContent = "Back to Sign In";
    } else {
      btnAuth.textContent = "Sign In";
      btnSwitchAuth.textContent = "Create your Amazon account";
    }
    inputUsername.value = "";
    inputPassword.value = "";
  });

  btnAuth.addEventListener("click", () => {
    const name = inputUsername.value.trim();
    const pass = inputPassword.value;
    if (!name || !pass) {
      loginMsg.style.color = "#ff5c5c";
      loginMsg.textContent = "Username and password required.";
      return;
    }
    if (isSignup) {
      if (users[name]) {
        loginMsg.style.color = "#ff5c5c";
        loginMsg.textContent = "User exists, pick another.";
        return;
      }
      users[name] = pass;
      loginMsg.style.color = "#8deffd";
      loginMsg.textContent = "Sign up successful. Please sign in.";
      isSignup = false;
      btnAuth.textContent = "Sign In";
      btnSwitchAuth.textContent = "Create your Amazon account";
      inputUsername.value = "";
      inputPassword.value = "";
      return;
    }
    if (users[name] === pass) {
      loginMsg.textContent = "";
      btnAuth.disabled = true;
      btnSwitchAuth.disabled = true;
      inputUsername.disabled = true;
      inputPassword.disabled = true;
      searchInput.disabled = false;
      searchBtn.disabled = false;
      folderUpload.disabled = false;
      offlineSearch.disabled = false;
      clearOfflineBtn.disabled = false;
      btnSignOut.style.display = "inline-block";
      disableTabs(false);
      switchTab("online");
      renderPlaylist();
    } else {
      loginMsg.style.color = "#ff5c5c";
      loginMsg.textContent = "Invalid credentials.";
    }
  });

  btnSignOut.addEventListener("click", () => {
    btnAuth.disabled = false;
    btnSwitchAuth.disabled = false;
    inputUsername.disabled = false;
    inputPassword.disabled = false;
    inputUsername.value = "";
    inputPassword.value = "";
    loginMsg.textContent = "";
    searchInput.value = "";
    searchInput.disabled = true;
    searchBtn.disabled = true;
    folderUpload.disabled = true;
    offlineSearch.disabled = true;
    clearOfflineBtn.disabled = true;
    btnSignOut.style.display = "none";
    onlineSongs = [];
    offlineFiles = [];
    playlist = [];
    localStorage.removeItem("playlist");
    onlineList.innerHTML = "";
    playlistList.innerHTML = "";
    offlineList.innerHTML = "";
    disableTabs(true);
    switchTab("online");
  });

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      if (tab.disabled) return;
      switchTab(tab.id.replace("tab", "").toLowerCase());
    });
  });

  searchBtn.addEventListener("click", () => {
    const q = searchInput.value.trim();
    if (!q) {
      onlineList.innerHTML = '<li style="color:#ff5c5c;">No search term entered.</li>';
      return;
    }
    fetchSongs(q);
  });

  searchInput.addEventListener("keydown", e => {
    if (e.key === "Enter") {
      e.preventDefault();
      searchBtn.click();
    }
  });

  async function fetchSongs(term) {
    onlineList.innerHTML = '<li>Loading...</li>';
    try {
      const resp = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(term)}&entity=song&limit=50`);
      const data = await resp.json();
      onlineSongs = data.results || [];
      renderOnlineSongs();
    } catch {
      onlineList.innerHTML = '<li style="color:#ff5c5c;">Error fetching songs.</li>';
    }
  }

  function renderOnlineSongs() {
    onlineList.innerHTML = "";
    if (onlineSongs.length === 0) {
      onlineList.innerHTML = "<li>No songs found.</li>";
      return;
    }
    onlineSongs.forEach(song => {
      const li = document.createElement("li");
      li.className = "songItem";
      li.innerHTML = `
        <img src="${song.artworkUrl100}" alt="Artwork for ${song.trackName}" loading="lazy" />
        <div>
          <strong class="title">${song.trackName}</strong><br/>
          <small class="subtitle">${song.artistName}</small>
        </div>
        <audio controls preload="none" src="${song.previewUrl}" aria-label="Play preview of ${song.trackName} by ${song.artistName}"></audio>
        <div class="actions">
          <button class="btnAction btnAddToPlaylist" aria-label="Add ${song.trackName} to playlist">Add to Playlist</button>
        </div>
      `;
      li.querySelector(".btnAddToPlaylist").addEventListener("click", () => {
        if (playlist.some(s => s.url === song.previewUrl)) {
          alert("Song already in playlist.");
          return;
        }
        playlist.push({
          trackName: song.trackName,
          artistName: song.artistName,
          url: song.previewUrl
        });
        savePlaylist();
        alert(`Added "${song.trackName}" to playlist.`);
        renderPlaylist(); // no tab switch on add
      });
      onlineList.appendChild(li);
    });
  }

  folderUpload.addEventListener("change", e => {
    offlineFiles.push(...Array.from(e.target.files || []));
    renderOfflineFiles();
  });

  offlineSearch.addEventListener("input", e => {
    const val = e.target.value.toLowerCase();
    renderOfflineFiles(offlineFiles.filter(f => f.name.toLowerCase().includes(val)));
  });

  clearOfflineBtn.addEventListener("click", () => {
    offlineFiles = [];
    offlineSearch.value = "";
    renderOfflineFiles();
  });

  function renderOfflineFiles(files = offlineFiles) {
    offlineList.innerHTML = "";
    if (files.length === 0) {
      offlineList.innerHTML = "<li>No offline songs loaded.</li>";
      return;
    }
    files.forEach(file => {
      const li = document.createElement("li");
      li.className = "songItem";
      const url = URL.createObjectURL(file);
      li.innerHTML = `
        <div class="title" title="${escapeHTML(file.name)}" style="max-width:100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${escapeHTML(file.name)}</div>
        <audio controls preload="none" src="${url}" aria-label="Play offline song ${escapeHTML(file.name)}"></audio>
        <div class="actions">
          <button class="btnAction btnDelete" aria-label="Delete offline song ${escapeHTML(file.name)}">Delete</button>
        </div>
      `;
      li.querySelector(".btnDelete").addEventListener("click", () => {
        offlineFiles = offlineFiles.filter(f => f !== file);
        renderOfflineFiles();
      });
      offlineList.appendChild(li);
    });
  }

  clearPlaylistBtn.addEventListener("click", () => {
    if (confirm("Clear playlist?")) {
      playlist = [];
      savePlaylist();
      renderPlaylist();
    }
  });

  function renderPlaylist() {
    playlistList.innerHTML = "";
    if (playlist.length === 0) {
      playlistList.innerHTML = "<li>No songs in playlist.</li>";
      return;
    }
    playlist.forEach((song, idx) => {
      const li = document.createElement("li");
      li.className = "songItem";
      li.innerHTML = `
        <div class="title">${song.trackName || "Unknown"}</div>
        <audio controls preload="none" src="${song.url}" aria-label="Play song ${song.trackName || "Unknown"}"></audio>
        <div class="actions">
          <button class="btnAction btnDelete" aria-label="Delete song ${song.trackName || "Unknown"}" data-idx="${idx}">Delete</button>
        </div>
      `;
      li.querySelector(".btnDelete").addEventListener("click", () => {
        playlist.splice(idx, 1);
        savePlaylist();
        renderPlaylist();
      });
      playlistList.appendChild(li);
    });
  }

  function savePlaylist() {
    localStorage.setItem("playlist", JSON.stringify(playlist));
  }

  function init() {
    searchInput.disabled = true;
    searchBtn.disabled = true;
    folderUpload.disabled = true;
    offlineSearch.disabled = true;
    clearOfflineBtn.disabled = true;
    btnAuth.disabled = false;
    btnSwitchAuth.disabled = false;
    inputUsername.disabled = false;
    inputPassword.disabled = false;
    btnSignOut.style.display = "none";
    playlist = JSON.parse(localStorage.getItem("playlist") || "[]");
    offlineFiles = [];
    onlineSongs = [];
    onlineList.innerHTML = "";
    offlineList.innerHTML = "";
    playlistList.innerHTML = "";
    disableTabs(true);
    switchTab("online");
    loginMsg.textContent = "";
  }

  init();
})();
</script>
</body>
</html>

